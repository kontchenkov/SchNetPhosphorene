# SchNetPhosphorene
Supplementary materials for article ... 

Установка и настройка пакета SchNet осуществляется согласно руководству
https://schnetpack.readthedocs.io/
Сам пакет schnetpack устанавливается в окружение schnetenv среды conda.
В этом окружении настраиваются все пакеты, необходимые для обучения сети.
Для использования обученной сети для вычисления потенциала межатомного взаимодействия
в ходе классической молекулярной динамики настраивается окружение spk_lammps.

1) В папке /out_cp должны лежать исходные данные для обучения - результаты моделирования черного фосфорена методом квантовой
молекулярной динамики Кара-Парринелло. Выборка содержит 100000 записей. Моделируется система из 16 атомов.
Эти данные размещены на Яндекс-диске, ссылка и перечень файлов - в текстовом файле.

2) Файл 0_prepare_data_files_100000.py содержит код для преобразования данных из файлов
    Ph.pos (координаты атомов),
    Ph.for (силы, действующие на каждый из атомов),
    Ph.evp (энергия системы атомов)
в формат NumPy (файлы Ph_pos.npy, Ph_for.npy, Ph_energy.npy). Эти файлы будут использоваться в дальнейшем
для формирования датасета.
Для запуска файла нужно активировать окружение schnetenv:
    conda activate schnetenv
Собственно запуск файла на исполнение осуществляется командой
    python 0_prepare_data_files_100000.py
   
3) Файл 1_prepare_database_100000.py с использованием данных из файлов Ph_pos.npy, Ph_for.npy, Ph_energy.npy
   базу данных dataset_100000_pbc.db, которая сохраняется в папке /forcetut.
   
4) Файл 1_start_learning_dataset_100000.py запускает обучение нейронной сети на данных,
хранящихся в датасете dataset_100000_pbc.db, в результате формируется модель phosphorene_model_256_9_500_100000_pbc_gpu
(индекс 500 обозначает количество эпох обучения).

6) Файл 2_calculate_forces_abs_values_100000.py служит для вычисления значения модулей сил, действующих на каждый из атомов,
на основе данных тестовой выборки (последние 5000 записей из 100000), по данным файлов Ph_pos.npy, Ph_for.npy (исходные данные).
Формируется файл lst_initial_data_all_by_atoms.npy.

7) Файл 3_calculate_model_forces_abs_values_100000_1000.py служит для вычисления значения модулей сил, действующих на каждый из атомов,
на основе данных тестовой выборки (последние 5000 записей из 100000), при помощи модели phosphorene_model_256_9_1000_100000_pbc_gpu
(обучена по аналогии с моделью phosphorene_model_256_9_500_100000_pbc_gpu, но вместо 500 использовалось 1000 эпох обучения).
Формируется файл lst_model_data_all_by_atoms_100000_1000.npy.

8) 

